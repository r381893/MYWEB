<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>庫洛米留言板</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">
    <header>
      <h1>庫洛米留言板 ❤️</h1>
      
      <!-- 登入狀態區 -->
      <div id="auth-section" class="auth-section">
        <div id="user-info" style="display: none;">
          <img id="user-avatar" src="" alt="avatar" class="user-avatar">
          <span id="user-name"></span>
          <button class="logout-btn" onclick="signOutUser()">登出</button>
        </div>
        <button id="login-btn" class="google-login-btn" onclick="signInWithGoogle()">
          🔐 使用 Google 登入
        </button>
      </div>
      
      <div class="header-controls">
        <button id="wallpaper-btn" class="theme-btn" onclick="changeWallpaper()" title="更換背景">🎨 更換背景</button>
      </div>

      <div class="avatar-selector" id="avatar-selector">
        <!-- Avatars will be injected by script.js -->
      </div>

      <div class="input-area">
        <div class="nickname-row">
          <input type="text" id="nickname" placeholder="你的暱稱 (選填)" class="nickname-input">
          <div class="quick-nicknames">
            <button onclick="setNickname('Luzia')">Luzia</button>
            <button onclick="setNickname('Jack')">Jack</button>
          </div>
        </div>
        <textarea id="message" placeholder="留下你的訊息..."></textarea>

        <div class="stickers">
          <span onclick="addSticker('💀')">💀</span>
          <span onclick="addSticker('💜')">💜</span>
          <span onclick="addSticker('😈')">😈</span>
          <span onclick="addSticker('🎀')">🎀</span>
          <span onclick="addSticker('✨')">✨</span>
          <span onclick="addSticker('🌸')">🌸</span>
          <span onclick="addSticker('🍰')">🍰</span>
          <span onclick="addSticker('🥺')">🥺</span>
          <span onclick="addSticker('🔥')">🔥</span>
          <span onclick="addSticker('👻')">👻</span>
        </div>

        <button class="submit-btn" onclick="submitMessage()">送出留言</button>
        
        <!-- 未登入提示 -->
        <p id="login-required-msg" class="login-required-msg" style="display: none;">
          💡 請先登入才能發送留言
        </p>
      </div>
    </header>

    <div class="search-container">
      <input type="text" id="search-input" placeholder="🔍 搜尋留言..." oninput="filterMessages()">
    </div>

    <section id="messages" class="messages-section"></section>

    <footer>
      <p>© 2025 庫洛米留言板 All Rights Reserved</p>
    </footer>
  </div>

  <!-- Music Player -->
  <div class="music-player">
    <button id="music-btn" onclick="toggleMusic()">🎵</button>
    <audio id="bg-music" loop>
      <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>
  </div>

  <!-- Falling Animation Container -->
  <div id="falling-container"></div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="script.js"></script>
</body>

</html>